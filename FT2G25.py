import warnings
import numpy as np

warnings.filterwarnings("ignore")

source_coordinates = {k: np.array(v, np.float64) for k, v in {
    "San Forager": [-0.622043,0.060424,0.02093,0.030039,-0.000462,0.000837,0.236773,-0.1823,0.018509,0.006743,0.00203,-0.053952,-0.021184,0.005505,0.018797,-0.021281,0.029662,0.262309,-0.087737,0.001751,-0.033191,-0.002844,0.003821,-0.005001,0.001676],
    "African Rainforest Forager (East)": [-0.647426,0.059104,0.025493,0.037404,-0.001108,0.006638,0.366335,-0.293434,0.017712,0.02985,-0.008931,0.219824,0.126451,0.001018,0.010342,-0.001405,0.000939,-0.051866,0.014229,0.003727,0.006114,-0.001855,-0.004388,0.00253,-0.000695],
    "African Rainforest Forager (West)": [-0.647426,0.059104,0.025493,0.037404,-0.001108,0.006638,0.366335,-0.293434,0.017712,0.02985,-0.008931,0.219824,0.126451,0.001018,0.010342,-0.001405,0.000939,-0.051866,0.014229,0.003727,0.006114,-0.001855,-0.004388,0.00253,-0.000695],
    "African Rainforest Forager (North)": [-0.647426,0.059104,0.025493,0.037404,-0.001108,0.006638,0.366335,-0.293434,0.017712,0.02985,-0.008931,0.219824,0.126451,0.001018,0.010342,-0.001405,0.000939,-0.051866,0.014229,0.003727,0.006114,-0.001855,-0.004388,0.00253,-0.000695],
    "Senegal, Gambia & Guinea-Bissau": [-0.606487,0.067195,0.019736,0.011467,0.002103,0.005578,-0.035839,0.038768,-0.031735,0.024146,0.005413,-0.003647,0.016229,-0.000986,0.011016,-0.015336,0.009692,-0.001182,-0.002116,-0.003231,-0.001643,-0.001814,0.004396,-1e-04,0.001377],
    "Guinea & Sierra Leone": [-0.536608,0.072956,0.017001,0.00062,0.006807,0.001484,-0.035186,0.033156,-0.015004,0.026752,0.004021,-0.003861,0.020152,-0.004481,0.01639,-0.012039,0.010827,-0.002635,-0.009513,0.000825,-0.002411,-0.009783,0.005078,-0.001745,0.003046],
    "Liberia & Ivory Coast": [-0.622612,0.064486,0.022863,0.017038,0.002962,0.009273,-0.022914,0.026883,-0.038808,0.027928,0.005744,-0.005039,0.017784,0.000516,0.010247,-0.007276,0.00942,0.006635,0.001037,-0.000391,0.003057,0.001314,-0.003374,-0.000256,-0.00018],
    "Ghana, Togo & Benin": [-0.630062,0.062501,0.022113,0.016708,0.000503,0.012474,-0.044417,0.047767,-0.048881,0.032769,0.004621,0.00079,0.023056,0.000951,0.012523,-0.009607,0.007076,0.000449,0.006022,-0.00299,0.001554,0.002316,-0.001759,-0.000471,-0.000425],
    "Nigeria": [-0.632145,0.064613,0.02324,0.01829,-0.003193,0.014677,-0.041215,0.046412,-0.051054,0.035035,0.008262,-0.001461,0.023358,0.003269,0.012147,-0.009513,0.006747,0.003294,0.006065,-0.003533,0.00039,0.001283,-0.000724,-0.000256,-0.000928],
    "Northern Congo Basin": [-0.622287,0.065864,0.018425,0.016012,0.000615,0.00757,0.001444,0.008934,-0.027435,0.017286,0.002853,-0.004646,-0.003037,0.001966,-0.005157,0.004887,-0.00339,0.02179,-0.010684,0.003788,-0.001177,0.000459,0.001497,0.000241,-0.000547],
    "Atlantic Equatorial Africa": [-0.622287,0.065864,0.018425,0.016012,0.000615,0.00757,0.001444,0.008934,-0.027435,0.017286,0.002853,-0.004646,-0.003037,0.001966,-0.005157,0.004887,-0.00339,0.02179,-0.010684,0.003788,-0.001177,0.000459,0.001497,0.000241,-0.000547],
    "Southern Congo Basin": [-0.622287,0.065864,0.018425,0.016012,0.000615,0.00757,0.001444,0.008934,-0.027435,0.017286,0.002853,-0.004646,-0.003037,0.001966,-0.005157,0.004887,-0.00339,0.02179,-0.010684,0.003788,-0.001177,0.000459,0.001497,0.000241,-0.000547],
    "Southern Africa": [-0.630959,0.063301,0.022125,0.017981,-0.000462,0.012271,-0.012299,0.023076,-0.031394,0.010965,0.000325,-0.000475,-0.010282,4.6e-05,-0.018028,0.011204,-0.0118,0.010937,-0.009658,0.003085,0.000749,-0.000886,0.002013,0.001526,-2e-04],
    "Western Lake Victoria Basin": [-0.439073,0.076165,-0.011361,-0.035813,-0.004809,-0.018651,-0.00658,0.004183,0.097941,-0.089979,-0.016848,0.005826,-0.025625,-0.001187,0.011876,-0.018165,0.022915,-0.005638,0.018446,-0.019916,-0.00117,-0.000124,-0.005361,-0.003344,0.004985],
    "Eastern Lake Victoria Basin": [-0.439073,0.076165,-0.011361,-0.035813,-0.004809,-0.018651,-0.00658,0.004183,0.097941,-0.089979,-0.016848,0.005826,-0.025625,-0.001187,0.011876,-0.018165,0.022915,-0.005638,0.018446,-0.019916,-0.00117,-0.000124,-0.005361,-0.003344,0.004985],
    "East African Savannah": [-0.439073,0.076165,-0.011361,-0.035813,-0.004809,-0.018651,-0.00658,0.004183,0.097941,-0.089979,-0.016848,0.005826,-0.025625,-0.001187,0.011876,-0.018165,0.022915,-0.005638,0.018446,-0.019916,-0.00117,-0.000124,-0.005361,-0.003344,0.004985],
    "Nile River Basin": [-0.577029,0.05213,0.001688,-0.007198,-0.002037,-0.00158,-0.013922,0.016999,0.074904,-0.091908,-0.019672,0.0236,-0.039112,0.000203,0.009164,-0.017085,0.018788,-0.010527,0.020818,-0.020069,0.001194,0.003733,-0.003838,-0.0014,0.005674],
    "Eritrea, Northern Ethiopia & Somalia": [-0.296623,0.093429,-0.026851,-0.069736,0.000954,-0.03408,-0.020493,0.005769,0.115392,-0.079674,-0.008948,-0.006669,0.005218,-0.001665,0.024728,-0.018616,0.014864,-0.001976,0.00998,-0.003839,0.000599,0.004946,-0.002736,-0.001241,-0.00279],
    "Southern Ethiopia": [-0.415454,0.065502,-0.016782,-0.039083,0.001693,-0.018407,0.028084,-0.027807,0.104818,-0.094125,-0.011205,-0.002173,-0.011967,-0.002202,0.025448,-0.018828,0.033118,0.021157,0.004525,-0.010005,-0.002246,0.000927,-0.002342,0.001747,-0.000838],
    "Maghreb & Egypt": [-0.095421,0.131341,-0.009664,-0.080683,0.024171,-0.035396,-0.032882,0.00899,0.077336,0.028884,0.010731,-0.009367,0.030562,-0.015569,0.023434,-0.014773,-0.003803,-0.024884,-0.048598,0.012443,-0.015078,-0.041553,0.027869,-0.002842,0.007589],
    "Bedouin": [0.028582,0.133599,-0.047601,-0.08276,-0.013883,-0.032351,-0.010706,-0.004641,0.023452,-0.00162,0.008173,-0.010724,0.024744,0.000474,0.001568,0.007057,-0.002738,-0.002238,-0.003408,0.008254,0.000208,0.002528,0.000192,0.001767,-0.001597],
    "Southern Levant": [0.048944,0.131206,-0.047442,-0.07442,-0.012618,-0.027276,-0.004935,-0.003231,0.014889,0.000838,0.006463,-0.008722,0.015996,-0.000936,-0.001113,0.009812,0.000104,0.000887,-0.002011,0.004227,0.001622,0.002893,-0.001134,0.002506,-0.002443],
    "Druze": [0.088782,0.140143,-0.048875,-0.072417,-0.013172,-0.023817,-0.001763,-0.004061,-0.001391,0.00687,0.005408,-0.003492,0.007522,8.3e-05,-0.006542,0.007398,-1.3e-05,0.000899,0.00455,-0.002376,-0.004205,0.002003,-0.001146,0.000374,0.00309],
    "Arabian Peninsula": [0.053393,0.141712,-0.064899,-0.114607,-0.012422,-0.04693,-0.012242,-0.008727,0.050424,-0.005169,0.017405,-0.032426,0.06383,0.00314,0.003924,0.029037,-0.022568,0.004814,-0.001394,0.031481,0.013023,0.018154,-0.007462,0.008884,-0.010113],
    "Yemenite Jewish": [0.050651,0.144916,-0.063469,-0.113761,-0.012002,-0.046714,-0.012785,-0.008561,0.04884,-0.007144,0.012212,-0.026646,0.053726,0.004927,0.003746,0.015738,-0.024512,0.005524,0.005744,0.022836,0.01264,0.015457,-0.00742,0.004266,-0.006023],
    "Northern Levant": [0.088149,0.145785,-0.048858,-0.078848,-0.012891,-0.03074,-0.000496,-0.004282,0.005181,0.010225,0.006658,-0.004529,0.01039,0,-0.010315,0.008471,-0.002101,0.001788,0.002542,-0.000125,0.000763,-0.000302,-0.00141,0.002356,-0.001211],
    "Mesopotamia, Armenia & Anatolia": [0.110847,0.142096,-0.04041,-0.060699,-0.014843,-0.018772,0.002802,-0.003657,-0.018879,0.009911,0.003635,0.003608,-0.003739,0.005748,-0.010022,-0.004172,0.002608,0.002826,0.005627,-0.003627,0.001286,0.004765,-0.002901,-0.000565,0.001326],
    "Sephardic Jewish": [0.075882,0.14583,-0.020063,-0.061004,0.011448,-0.023538,-0.008617,-0.002723,0.018284,0.022707,0.005456,-0.002258,0.005382,-0.003202,0.002479,-0.003934,-0.003555,-0.004865,-0.012235,-0.002518,-0.003119,-0.008944,0.007921,-0.003976,0.001772],
    "Mizrahi Jewish": [0.090299,0.13845,-0.066667,-0.075259,-0.024757,-0.021723,-0.001332,-0.008333,-0.011363,-0.001215,0.004565,-0.005578,0.011563,0.005306,-0.007932,0.008957,-0.005056,8.5e-05,0.002682,-0.010436,0.000735,-0.002583,-0.00267,-0.002504,0.001716],
    "Ashkenazi Jewish": [0.100117,0.136843,-0.007338,-0.043,0.009797,-0.015409,-0.000881,-0.000894,0.008198,0.014275,0.001164,-0.000593,0.00288,0.000166,-0.004145,-0.001674,-0.003765,3.2e-05,-0.000807,-0.004064,-0.002678,-0.002272,0.001689,0.002169,0.001527],
    "Southern Caucasus": [0.103043,0.13632,-0.059386,-0.061959,-0.026883,-0.01734,0.004285,-0.00452,-0.028176,-0.00343,0.003047,0.003332,-0.002702,0.00251,-0.005525,-0.001794,0.00092,0.001319,0.003948,-0.004451,0.000235,0.004044,-0.001261,-0.000269,0.001212],
    "Northern Caucasus": [0.112811,0.103359,-0.029751,-0.019237,-0.033442,-0.002076,0.009165,-0.003205,-0.051699,-0.024217,0.000686,0.007527,-0.020168,0.004557,0.005233,-0.016235,0.008678,-0.004617,-0.011969,0.019357,0.009566,0.000893,0.002602,-0.007257,-0.002847],
    "Eastern Caucasus": [0.110029,0.136081,-0.059208,-0.050819,-0.040213,-0.012085,0.006737,-0.008384,-0.057812,-0.016037,-0.001678,0.008692,-0.02225,0.004083,-4.5e-05,-0.0179,0.012604,-0.005152,-0.006872,0.015382,0.008693,0.005977,0.000945,-0.009479,0.002116],
    "Basque": [0.126424,0.148739,0.055679,0.00879,0.05545,0.000249,-0.001754,2.5e-05,0.029539,0.042923,-0.005214,0.010801,-0.024986,-0.019493,0.015807,0.002614,-0.00563,0.003172,-0.002375,-0.001791,0.008819,0.002204,-0.006479,-0.008654,0.00115],
    "Malta": [0.091912,0.14649,-0.002498,-0.043403,0.013272,-0.017814,-0.004406,-0.000923,0.011095,0.020524,0.00615,0.000974,-0.002899,-0.000723,-0.004258,0.000878,-0.000407,-0.003769,-0.000487,-0.002361,-0.006145,-0.002597,0.002819,0.00119,0.002904],
    "Sardinia": [0.121687,0.167285,0.02849,-0.050652,0.060151,-0.022134,-0.003952,0.002496,0.041574,0.077351,-5.9e-05,0.016649,-0.028664,-0.012974,-0.013572,-0.003001,0.011403,-0.001347,0.00168,-0.012995,-0.002121,-0.001102,-0.010084,-0.021383,0.000337],
    "Italian Peninsula": [0.11881,0.147784,0.013882,-0.021011,0.025294,-0.008938,-0.001063,-0.001626,0.005649,0.023239,-0.000309,0.006066,-0.011475,-0.003703,-0.002243,-0.000814,0.002154,0.00029,0.003334,-0.003829,-0.001967,0.001407,-0.000734,0.003196,-0.001226],
    "Greece & Balkans": [0.12224,0.143591,0.017566,-0.015768,0.026394,-0.007339,0.002499,0.001469,0.001507,0.017312,-0.000863,0.003573,-0.00624,0.006284,-0.019308,-0.002097,0.011999,0.000537,0.0074,-0.006184,-0.008088,0.001409,0.002835,0.003358,-0.003032],
    "Iberian Peninsula": [0.107753,0.143867,0.040477,-0.002153,0.043803,0.001859,-0.001723,0.004615,0.028429,0.029218,-0.002328,0.007843,-0.012091,-0.012019,0.01226,-0.006541,-0.00678,-0.001731,-0.004525,-0.002293,0.000291,-0.000907,0.001315,-0.002571,-0.002754],
    "Magyar": [0.127076,0.129625,0.055356,0.03643,0.03638,0.011933,0.006614,0.007533,0.00206,-0.004673,-0.001473,-0.002719,0.003855,0.008749,-0.004372,0.000123,-8.4e-05,-0.000389,0.002649,-0.001322,-0.003378,0.001387,0.005529,0.002694,0.000479],
    "West Slavic": [0.13184,0.12927,0.069868,0.057738,0.040676,0.021713,0.008678,0.010863,-0.000933,-0.018553,-0.004349,-0.006419,0.013093,0.018629,-0.007024,-0.00056,0.001546,-7.4e-05,0.002695,0.001287,-0.003129,-0.003119,0.005606,-0.003333,-8.8e-05],
    "East Slavic": [0.135449,0.122117,0.069579,0.056687,0.036853,0.019801,0.011986,0.014134,-0.004397,-0.021686,-0.00203,-0.010303,0.019698,0.021297,-0.013029,-0.002884,0.005574,0.001077,0.003614,0.002407,-0.003775,-0.005904,0.005423,-0.006989,0.000988],
    "Central Europe": [0.127171,0.141436,0.050431,0.02399,0.040903,0.009305,0.002799,0.005454,0.011602,0.018174,-0.007706,0.006812,-0.012906,-0.010384,0.01377,0.006063,-0.001825,0.004664,0.002708,-0.000978,0.002201,0.003575,-0.001232,0.011141,-0.001905],
    "England, Wales & Scotland": [0.131855,0.137043,0.061788,0.044013,0.03923,0.016748,0.004985,0.005745,0.005264,0.005678,-0.004769,0.005616,-0.012589,-0.010351,0.020615,0.003552,-0.010369,0.004094,0.003685,0.002962,0.005937,0.003404,-0.003269,0.013794,3.1e-05],
    "Ireland": [0.133361,0.134098,0.061169,0.048864,0.037788,0.019352,0.003293,0.004713,0.003568,0.002927,-0.006971,0.00584,-0.014189,-0.014076,0.025935,0.005215,-0.011145,0.001894,0.000597,0.001776,0.005114,0.001279,0.000293,0.014407,0.000661],
    "Scandinavia": [0.132193,0.125885,0.072642,0.058972,0.040264,0.02079,0.00638,0.009294,0.003649,-0.006663,-0.004203,0.000533,-0.003045,-0.003352,0.014593,0.005865,-0.005106,0.001622,0.002991,0.005015,0.006773,0.002526,0.001253,0.011594,0.000212],
    "Baltic": [0.135108,0.124098,0.083306,0.080524,0.043116,0.029423,0.012315,0.015207,-0.0045,-0.032347,-0.00302,-0.012469,0.024053,0.030002,-0.015296,0.001724,0.007002,-0.001394,0.00494,0.003014,-0.005328,-0.006034,0.010057,-0.006639,-0.000371],
    "Finland": [0.13077,0.086658,0.089419,0.07831,0.029544,0.02414,0.010419,0.015025,0.003159,-0.024055,0.003609,-0.006394,0.012768,0.005459,0.002021,0.00056,-0.007186,-0.000451,-5.6e-05,0.002626,0.008083,-0.001869,0.001479,0.008649,0.004338],
    "Indus Valley": [0.07275,0.000757,-0.10378,0.080723,-0.070121,0.047708,0.001635,0.004399,-0.000844,-0.005417,-0.005763,-0.000172,-0.000348,-0.00708,0.010373,0.008489,-0.003945,0.001084,0.000773,-0.010388,-0.002296,-0.00547,0.000857,-0.000718,0.000428],
    "Afghanistan & Northern Pakistan": [0.086696,0.042144,-0.072156,0.039568,-0.062986,0.028958,0.004152,0.001154,-0.020896,-0.020623,-0.003194,0.000724,0.001487,-0.005826,0.014522,0.013303,-0.00665,0.002365,0.002807,-0.015091,-0.002475,-0.005482,0.004334,-0.007612,0.003233],
    "Western India": [0.068578,-0.002031,-0.119076,0.079701,-0.078707,0.04783,0.002761,0.006404,-0.001534,-0.006287,-0.007307,0.000487,0.001487,-0.007466,0.010247,0.018496,0.002217,-0.001552,0.002325,-0.013944,-0.001279,-0.010912,6.2e-05,-0.005603,0.003024],
    "Northern India": [0.07057,-0.008124,-0.110119,0.073644,-0.075399,0.048806,0.0047,0,0.006749,0.004191,-0.005521,-0.003297,0.001487,-0.012386,0.002986,0.018165,0.016037,-0.004307,0.00088,-0.004252,-0.000624,-0.017435,-0.000616,-0.003374,-0.000718],
    "Southern India": [0.044391,-0.075149,-0.164425,0.105299,-0.074783,0.058009,-0.00094,0.016845,0.036405,0.024055,0.001137,0.004346,0.000446,0.002064,-0.001493,-0.003182,-0.002608,0.0019,-0.002011,-0.000125,0.008235,0.000124,0.003697,-0.005422,0.005029],
    "Eastern India": [0.041713,-0.119503,-0.145613,0.099722,-0.052951,0.061758,-0.001611,0.011769,0.041885,0.025695,-0.004585,0.001389,-4.4e-05,6.9e-05,-0.006151,-0.006579,0.004556,-0.000693,-0.00291,0.004521,0.000907,0.002811,0.001316,0.004852,0.000257],
    "Mongolia": [0.051676,-0.327813,0.063884,-0.026551,-0.045916,-0.02973,0.014242,0.017768,-0.000941,0.008966,-0.03212,-0.003117,-0.000327,-0.000743,0.003257,0.000689,-0.00339,0.000101,0.004223,0.009029,-0.021537,-0.009571,-0.01861,0.000265,0.000742],
    "Southern Siberia": [0.065808,-0.222027,0.046306,-0.008186,-0.036703,-0.014635,0.011163,0.012425,-0.0045,-0.000724,-0.022546,-0.002552,0.000974,-0.000456,0.001682,0.001734,-0.002505,-0.00055,0.001624,0.007497,-0.011847,-0.005138,-0.00987,-0.000282,6e-06],
    "Kalash": [0.083883,0.024991,-0.084032,0.066595,-0.071679,0.040306,0.003116,0.002017,-0.030927,-0.025156,-0.005592,-0.000495,-0.002392,-0.010902,0.016611,0.008762,-0.013821,0.002104,0.000672,-0.012832,-0.003922,-0.005392,0.002861,-0.003426,0.003353],
    "Northwestern Siberia": [0.044992,-0.411402,0.155635,0.00035,-0.160996,-0.09019,0.028671,0.0413,0.029406,0.013354,0.101939,0.0091,-0.004018,-0.02658,-0.020354,-0.010464,0.001934,0.013971,0.025496,-0.000886,0.042481,-0.012956,0.032291,0.000321,0.013],
    "Western Siberian Plains": [0.041103,-0.426522,0.13283,-0.018734,-0.139359,-0.084163,0.029455,0.040806,0.026281,0.020866,0.061455,0.008975,-0.014527,0.010712,-0.002028,-0.00053,0.003361,0.006743,0.012549,-0.002189,0.030932,-0.014117,0.012688,0.005007,0.012148],
    "Central & Eastern Siberia": [0.046057,-0.377777,0.105715,-0.021468,-0.105866,-0.063607,0.029519,0.037226,0.02138,0.022942,0.027252,0.010234,-0.022246,0.063763,0.034323,0.022214,0.006258,-0.014556,-0.036794,-0.028228,-0.001163,0.032141,0.004961,-0.001149,-0.013519],
    "Taimyr Peninsula": [0.046057,-0.377777,0.105715,-0.021468,-0.105866,-0.063607,0.029519,0.037226,0.02138,0.022942,0.027252,0.010234,-0.022246,0.063763,0.034323,0.022214,0.006258,-0.014556,-0.036794,-0.028228,-0.001163,0.032141,0.004961,-0.001149,-0.013519],
    "Yakut": [0.046057,-0.377777,0.105715,-0.021468,-0.105866,-0.063607,0.029519,0.037226,0.02138,0.022942,0.027252,0.010234,-0.022246,0.063763,0.034323,0.022214,0.006258,-0.014556,-0.036794,-0.028228,-0.001163,0.032141,0.004961,-0.001149,-0.013519],
    "Northeastern Siberia": [0.046667,-0.378792,0.119698,0.02668,-0.121807,-0.053212,-0.061432,-0.068582,0.00814,-0.006087,0.037349,-0.001589,0.004965,-0.022625,-0.033306,-0.018563,-0.000287,0.016267,0.035975,0.019885,0.036461,-0.054679,0.0123,0.022726,0.034799],
    "Inuit": [0.046229,-0.36356,0.120562,0.044376,-0.120094,-0.042413,-0.105249,-0.122214,0.006261,-0.013233,0.029617,-0.004865,0.010303,-0.017806,-0.032625,-0.013575,0.00013,0.013634,0.035959,0.018913,0.028498,-0.050022,0.009964,0.026593,0.041977],
    "Amerindian – North America": [0.052928,-0.328016,0.112005,0.07744,-0.106174,-0.018407,-0.198349,-0.234798,-0.003733,-0.020137,0.008282,-0.003409,0.006392,6.9e-05,-0.015133,-0.004508,-0.000522,0.003262,0.011501,0.007347,0.003868,-0.010758,0.002711,0.006206,0.009281],
    "Amerindian – North Mexico": [0.051676,-0.312783,0.107706,0.09057,-0.107343,-0.015953,-0.269933,-0.327309,-0.012517,-0.017713,-0.003248,-0.002218,0.005382,0.019487,-0.00912,0.010952,0.006258,0.006436,0.004626,-0.003152,-0.002496,0.004451,-0.001972,0.003181,0.003329],
    "Amerindian – Yucatan Peninsula": [0.056749,-0.294939,0.110766,0.090256,-0.104855,-0.015698,-0.275835,-0.328635,-0.014083,-0.016037,-0.001717,-0.001006,0.001083,0.019995,-0.008783,0.00375,0.007916,-0.000977,-0.001347,-0.001947,-0.002603,0.005617,0.001004,3.4e-05,0.000359],
    "Amerindian – Central & South Mexico": [0.053952,-0.298363,0.112533,0.091926,-0.103835,-0.015953,-0.267254,-0.324263,-0.006627,-0.014251,-0.005002,-0.005755,0.003003,0.020038,-0.005836,0.000159,0.002816,-0.000785,0.002615,0.001251,-0.002471,0.005243,9.9e-05,0.000386,-0.001269],
    "Amerindian – Central America": [0.053269,-0.297144,0.113438,0.091668,-0.100634,-0.018686,-0.26904,-0.321125,-0.012762,-0.014579,-0.005359,-0.005665,-0.000208,0.016157,-0.008469,0.001724,0.005085,0.001799,0.001986,-0.001,-0.002945,0.006529,-0.000739,-0.002482,-0.001317],
    "Amerindian – Andes & Caribbean": [0.056229,-0.269522,0.1111,0.087469,-0.09688,-0.016957,-0.273881,-0.327263,-0.01129,-0.012392,-0.004027,-0.002008,-0.002438,0.021937,-0.003664,0.008221,0.007745,-0.001824,-2.5e-05,0.000425,-0.001073,0.009224,0.000468,0.003519,-0.002155],
    "Amerindian – Argentina & Chile": [0.056229,-0.269522,0.1111,0.087469,-0.09688,-0.016957,-0.273881,-0.327263,-0.01129,-0.012392,-0.004027,-0.002008,-0.002438,0.021937,-0.003664,0.008221,0.007745,-0.001824,-2.5e-05,0.000425,-0.001073,0.009224,0.000468,0.003519,-0.002155],
    "Amerindian – Amazon": [0.057822,-0.317454,0.117134,0.10672,-0.113806,-0.015395,-0.325819,-0.391691,-0.017548,-0.020775,0.002079,-0.004676,0.002319,0.035864,-0.013491,0.000583,0.0109,-0.001242,0.000251,0.001276,-0.003544,0.012662,-0.006779,-0.007447,-0.009149],
    "Japan": [0.022955,-0.445479,0.013074,-0.059109,0.036212,0.009343,0.003525,0.000577,-0.006511,0.010661,-0.074049,-0.007468,0.011546,-0.007065,-0.011061,-0.004464,0.000304,0.003589,0.001676,-0.009254,0.027036,-0.01659,0.004909,0.003374,-0.041972],
    "Korean Peninsula": [0.022622,-0.455486,0.018157,-0.064129,0.038828,0.011603,0.005097,0.0035,-0.009523,0.006633,-0.075044,-0.008652,0.010128,-0.005809,-0.009008,-0.002497,0.000891,0.001879,-0.000168,-0.007308,0.016234,-0.004364,0.007405,0.000994,-0.017493],
    "Northern Han": [0.029594,-0.447341,-0.001697,-0.069445,0.058472,0.03263,0.003643,0.002423,-0.015135,-0.003554,-0.076079,-0.015511,0.011373,-0.002546,-0.003664,0.007756,0.003846,0.004371,0.004651,-0.017071,0.016533,0.00779,0.011955,-0.003073,-0.005149],
    "Southern Han": [0.019187,-0.45249,-0.020796,-0.070968,0.10103,0.04765,0.000269,-0.008736,-0.015106,-0.006717,-0.030622,-0.003618,0.005777,-0.00407,-0.004188,0.002652,-0.000335,0.002244,-0.000664,-0.015668,0.013726,0.008656,0.012624,0.000207,-0.002652],
    "Thailand and Southern China": [0.019691,-0.374223,-0.063092,-0.028198,0.093556,0.054858,-0.003243,-0.006115,-0.004868,-0.005941,0.020087,0.002008,-0.005322,0.000358,0.000597,-2.7e-05,-0.000561,-0.002128,-0.003696,-0.002164,0.00166,0.007605,0.003081,0.001904,0.013172],
    "Laos, Vietnam & Cambodia": [0.016694,-0.399441,-0.061973,-0.034346,0.115919,0.061821,0.000235,-0.005538,-0.005659,-0.011602,0.039406,0.001848,-0.001784,-0.002752,-0.001538,-0.003978,-0.002303,-0.002576,-0.004735,0.005586,-0.003785,0.011211,-0.000698,8e-05,0.021515],
    "Yao": [-0.626198,0.06276,0.020119,0.014454,0.000215,0.011058,-0.009835,0.019072,-0.02622,0.009832,-8e-06,0.000907,-0.014108,0.002849,-0.01858,0.013624,-0.013958,0.012327,-0.01152,0.004702,-0.001135,-0.001379,0.001541,-0.001633,-0.001012],
    "Myanmar": [0.010244,-0.420937,-0.041596,-0.036112,0.097064,0.046073,-0.000282,-0.005838,-0.002148,-0.003062,0.010831,0.004181,-0.000208,0.005092,-0.004438,-0.002002,0.001695,-0.003725,-0.004601,0.007966,-0.009808,0.019846,-0.000998,0.003711,0.0442],
    "Malaysia & Western Indonesia": [0.012521,-0.385901,-0.072105,-0.027907,0.122238,0.054216,-0.002961,-0.007246,-0.011126,-0.015672,0.058232,0.006624,-0.007255,0.002312,0.00722,0.001273,-0.005241,-0.000152,0.00269,0.002226,-0.009658,-0.004996,-0.00917,-0.002651,0.000742],
    "Northern Borneo": [0.012521,-0.385901,-0.072105,-0.027907,0.122238,0.054216,-0.002961,-0.007246,-0.011126,-0.015672,0.058232,0.006624,-0.007255,0.002312,0.00722,0.001273,-0.005241,-0.000152,0.00269,0.002226,-0.009658,-0.004996,-0.00917,-0.002651,0.000742],
    "Southern Borneo": [0.012521,-0.385901,-0.072105,-0.027907,0.122238,0.054216,-0.002961,-0.007246,-0.011126,-0.015672,0.058232,0.006624,-0.007255,0.002312,0.00722,0.001273,-0.005241,-0.000152,0.00269,0.002226,-0.009658,-0.004996,-0.00917,-0.002651,0.000742],
    "South Wallacea Islands": [0.012521,-0.385901,-0.072105,-0.027907,0.122238,0.054216,-0.002961,-0.007246,-0.011126,-0.015672,0.058232,0.006624,-0.007255,0.002312,0.00722,0.001273,-0.005241,-0.000152,0.00269,0.002226,-0.009658,-0.004996,-0.00917,-0.002651,0.000742],
    "Philippine Lowlands": [0.012521,-0.385901,-0.072105,-0.027907,0.122238,0.054216,-0.002961,-0.007246,-0.011126,-0.015672,0.058232,0.006624,-0.007255,0.002312,0.00722,0.001273,-0.005241,-0.000152,0.00269,0.002226,-0.009658,-0.004996,-0.00917,-0.002651,0.000742],
    "Philippine Austronesian": [0.011599,-0.403697,-0.079321,-0.034454,0.141829,0.066044,-0.004667,-0.013087,-0.010947,-0.018658,0.084048,0.007765,-0.009592,0.007091,0.005765,0.002412,-0.00118,-0.001822,0.000257,0.011738,-0.014011,0.002349,-0.013393,0.001429,0.020893],
    "Philippine Melanesian": [0.011599,-0.403697,-0.079321,-0.034454,0.141829,0.066044,-0.004667,-0.013087,-0.010947,-0.018658,0.084048,0.007765,-0.009592,0.007091,0.005765,0.002412,-0.00118,-0.001822,0.000257,0.011738,-0.014011,0.002349,-0.013393,0.001429,0.020893],
    "Polynesia": [-0.003415,-0.414336,-0.053928,-0.045543,0.140642,0.029562,-0.00517,-0.011076,-0.022498,-0.020957,0.040272,0.003597,-0.005798,0.001239,0.012758,0.013657,0.000261,0.011022,0.005531,-0.007379,0.000125,-0.026585,-0.003944,-0.003615,-0.058677],
    "Melanesia": [-0.045985,-0.241087,-0.263758,0.309242,0.206931,-0.509589,-0.001974,0.007015,-0.041273,-0.011955,-0.018902,0.000869,0.001397,-0.00311,0.000163,-0.000318,-0.00219,-0.00185,-0.001081,-0.001526,0.002346,0.001805,0.001232,0.001832,0.001605],
    "Sahul": [-0.042115,-0.235095,-0.213639,0.234499,0.138487,-0.340247,-0.003173,0.0075,-0.008283,0.00082,-0.006171,0.001199,0.000818,-0.002684,-0.003529,-0.000133,0.01004,0.002027,-0.002388,0.006065,0.003556,-0.000371,-0.003389,0.001265,-0.00455]
}.items()}

reference_data = np.loadtxt("data", "str", "#", ";")

total_weight = np.sum(reference_data[:, 1].astype(float))

contributions = [
    source_coordinates[row[0]] * (float(row[1]) / total_weight)
    for row in reference_data
    if row[0] in source_coordinates
]
final_result = np.sum(contributions, axis=0) if contributions else np.zeros(25)

final_result_str = ",".join(f"{x:.6f}" for x in final_result)
print(f"sample_FT2G25_sim,{final_result_str}")
